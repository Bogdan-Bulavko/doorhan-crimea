# Инструкции по миграции: Управление меню и SEO шаблоны

## 1. Применение миграции базы данных

На сервере выполните следующую команду для применения миграции:

```bash
# Применить миграцию для таблиц Menu и MenuItem
sqlite3 your_database.db < prisma/migration-add-menus.sql
```

Или через Prisma CLI (если используется):

```bash
npx prisma db push
```

## 2. Инициализация меню

После применения миграции выполните скрипт для создания начальных меню (header и footer):

```bash
npx tsx scripts/init-menus.ts
```

Этот скрипт создаст:
- Меню "header" с пунктами: Главная, Категории, О компании, Контакты
- Меню "footer" с секциями: Продукция, Услуги, Компания (с подпунктами)

## 3. Инициализация SEO шаблонов

Выполните скрипт для заполнения SEO шаблонов с переменными города:

```bash
npx tsx scripts/init-seo-templates.ts
```

Этот скрипт заполнит настройки в таблице `SiteSetting` примерами с переменными:
- `[город]` - название города в именительном падеже
- `[город_в_предложном]` - название города в предложном падеже
- `[город_в_дательном]` - название города в дательном падеже

## 4. Проверка работы

После выполнения всех шагов:

1. Проверьте админку: `/admin/menus` - должны отображаться меню header и footer
2. Проверьте настройки: `/admin/settings` - должны быть заполнены SEO шаблоны
3. Проверьте фронтенд - меню в Header и Footer должны загружаться из БД
4. Проверьте SEO - переменные города должны заменяться на реальные значения

## 5. Использование переменных в SEO

В админке в разделе "Настройки" (`/admin/settings`) вы можете использовать следующие переменные:

- `[город]` - Симферополь, Ялта, Алушта, Севастополь, Крым
- `[город_в_предложном]` - в Симферополе, в Ялте, в Алуште, в Севастополе, в Крыму
- `[город_в_дательном]` - Симферополю, Ялте, Алуште, Севастополю, Крыму

Примеры:
- Заголовок: `DoorHan [город] - Ворота и автоматика`
- Описание: `Официальный представитель DoorHan в [город_в_предложном]. Ворота, роллеты, автоматические системы.`

## 6. Редактирование меню

Меню можно редактировать через админку:
- `/admin/menus` - список всех меню
- `/admin/menus/[id]` - редактирование меню
- `/admin/menus/[id]/items/new` - добавление пункта меню
- `/admin/menus/[id]/items/[itemId]` - редактирование пункта меню

## 7. SEO поля для категорий и товаров

В формах редактирования категорий и товаров добавлены поля:
- **Robots Meta** - управление индексацией (index/noindex, follow/nofollow)
- **Schema Markup** - JSON-LD разметка для структурированных данных

Эти поля доступны в:
- `/admin/categories/[id]` - редактирование категории
- `/admin/products/[id]` - редактирование товара

